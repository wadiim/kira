#!/usr/bin/env ruby
# -*- coding: utf-8 -*-

require 'kira'
require 'getoptlong'

opts = GetoptLong.new(
  ['--help', '-h', GetoptLong::NO_ARGUMENT],
  ['--version', '-V', GetoptLong::NO_ARGUMENT]
)

opts.each do |opt, arg|
  case opt
  when '--help'
    puts <<~EOF
      Usage: #{$0} [options]

      Options:
        -h, --help      display this help and exit
        -V, --version   output version information and exit
    EOF
    exit 0
  when '--version'
    puts "Kira #{Kira::VERSION}"
    exit 0
  end
end

begin
  input = $stdin.read
  sudoku = Kira::Sudoku.new(input)
  unless sudoku.solve
    raise StandardError.new("Over-constrained puzzle")
  end
  puts sudoku.to_s + "\n"
rescue StandardError => e
  STDERR.puts "Error: " + e.message
end
